async function initTTML() {
  const renderDiv = document.getElementById("render-div");
  const myVideo = document.getElementById("imscVideo");
  //Track object generated by the first <track> child element
  const myTrack = myVideo.textTracks[0];
  //Src is only available from the <track> DOM element, not the obj
  const ttmlUrl = myVideo.getElementsByTagName("track")[0].src;
  //The track is disabled by default, 'hidden' does not display VTT Text
  //but fires the events
  myTrack.mode = "hidden";

  const response = await fetch(ttmlUrl);
  initTrack(await response.text());

  function initTrack(text) {
    const imscDoc = imsc.fromXML(text);
    const timeEvents = imscDoc.getMediaTimeEvents();
    //create cue per timed event and render isd
    for (let i = 0; i < timeEvents.length; i++) {
      //Edge/IE implement "Generic Cue", other browsers VTTCue
      const Cue = window.VTTCue || window.TextTrackCue;
      let myCue;
      if (i < timeEvents.length - 1) {
        //We have to provide empty string as VTTText
        myCue = new Cue(timeEvents[i], timeEvents[i + 1], "");
      } else {
        /*
      "End" time of last "imsc event" is end of video
      */
        myCue = new Cue(timeEvents[i], myVideo.duration, "");
      }
      myCue.addEventListener("enter", function () {
        clearSubFromScreen();
        const myIsd = imsc.generateISD(imscDoc, this.startTime);
        imsc.renderHTML(myIsd, renderDiv);
      });
      myCue.addEventListener("exit", function () {
        clearSubFromScreen();
      });
      const r = myTrack.addCue(myCue);
    }
  }

  function clearSubFromScreen() {
    const subtitleActive = renderDiv.getElementsByTagName("div")[0];
    if (subtitleActive) {
      renderDiv.removeChild(subtitleActive);
    }
  }
}

window.addEventListener("load", initTTML);
